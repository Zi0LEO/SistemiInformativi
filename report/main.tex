\input{preamble}

\author{Umberto Frega, Leonardo Napoli}
\setlength{\headheight}{15pt}
\setlength{\footskip}{47.5pt}
\addtolength{\topmargin}{-0.49998pt}

\fancyhf{}
\fancyfoot[r]{\includegraphics[width=1.5cm]{assets/logo.png}}
\fancyfoot[L]{\thepage}
\fancyhead[L]{OPCal}
\fancyhead[R]{\theauthor}

\begin{document}\pagestyle{fancy}

\begin{titlepage}
  \centering
  {\Large \bfseries Progetto di MODULO 2: Laboratorio di Sistemi Informativi\par}
  {\Large Anno Accademico 2024/2025 \par}
  \vspace{1cm} % Adjust if necessary
  \vfill
  {\huge Sistema Informativo per l'Organizzazione Postale Calabrese\par}
  \vfill
  \noindent
  \begin{minipage}[t]{0.5\textwidth}
    \raggedright
    Docente \\  prof. Francesco Parisi
  \end{minipage}%
  \hfill
  \begin{minipage}[t]{0.4\textwidth}
    \raggedleft
    Studenti \\ Umberto Frega 239527 \\ Leonardo Napoli 234364
  \end{minipage}

\end{titlepage}
\tableofcontents
\newpage
\section{Introduzione}
L'Organizzazione Postale Calabrese (OPCal) affiliato a Poste Italiane, con sede legale a Cosenza e filiale a Rende(CS), 
consiste in un Ufficio atto alla spedizione e ricezione di corrispondenze.
\subsection{Sede}
La sede di Rende(CS) in via Marconi, 11 è una piccola struttura avente 3 sportelli e un magazzino. La sua clientela è composta 
prevalentemente da studenti della vicina Università della Calabria che effettuano operazioni di ricevimento pacchi.
La fondazione dell'ufficio risale al 2017, pertanto l'attuale sistema informativo è datato.
\subsection{Organizzativo}
Il direttore dal 2020 è il sig.Lucio Dalla. L'ufficio è diviso in 3 sezioni, la sezione Sportello con 3 dipendenti è gestita 
dal sig.Francesco de Gregori, la sezione Magazzino con 2 dipendenti è gestita dal sig.Adriano Celentano e la sezione Recapiti 
è gestita dal sig.Francesco Guccini con 2 dipendenti al suo seguito. In totale l'organizzazione ammonta a 11 dipendenti.
\begin{figure}[h]
  \centering
  \includegraphics[width=0.8\linewidth]{assets/organigramma.jpg}
  \caption{Organigramma}
\end{figure}
\subsection{Posizione nel Mercato}
L'OPCal detiene ad oggi gran parte del palcoscenico postale cosentino, i competitor sono per la maggioranza servizi privati in rapida ascesa.
\subsection{Prospettive Future}
Nel breve termine l'obiettivo della OPCal rimane il mantenere le quote di mercato nell'area metropolitana cosentina con uno sguardo 
verso l'esterno, con la possibilità a medio/lungo termine di espandere il proprio mercato all'intera area calabrese, continuando a 
garantire una politica di serietà e velocità nel servizio e disponibilità del personale.
\subsection{Benefici Attesi}
L'implementazione del sistema all'interno dell'organizzazione aziendale porterà diversi benefici, come:
\begin{itemize}
  \item Rinnovamento del sistema attuale;
  \item Centralizzazione delle funzionalità;
  \item Centralizzazione dei dati;
  \item Rimozione della dipendenza da documenti cartacei;
  \item Maggiore possibilità di estensione dell'organizzazione;
  \item Semplificazione e deburocratizzazione della user experience;
  \item Possibilità di avere un sistema pubblicitario più esteso ed efficiente tramite il sito web;

\end{itemize}
\subsection{Funzionalità}
Le macro-funzionalità fornite dal sistema infomativo sono le seguenti:
\begin{enumerate}
  \item \textbf{Gestione dei Clienti} \begin{itemize}
      \item Il sistema avrà la funzionalità di mantenere, organizzare e visualizzare le informazioni riguardanti i clienti, 
        quali \textit{spedizioni a carico}, \textit{saldo corrente} e \textit{pacchi in arrivo}.
      \item Ogni cliente avrà la possibilità di visualizzare i suoi dati, prenotarsi allo sportello e prenotare una spedizione 
        tramite le interfacce offerte.
      \item L'utente potrà gestire il proprio saldo corrente e decidere come utilizzarlo.
      \item Il sistema sarà inizialmente disponibile esclusivamente come applicazione per pc.
    \end{itemize}
  \item \textbf{Gestione dei Dipendenti} \begin{itemize}
      \item Il sistema terrà traccia dei vari dipendenti e delle operazioni che svolgono durante il giorno, nonchè dei loro 
        turni e delle loro buste paga.
      \item Il responsabile di ciascun settore potrà visualizzare le prestazioni dei propri subordinati, allo scopo di 
        ammonire e/o premiare i dipendenti meritevoli tramite un sistema di punti.
      \item Ogni dipendente potrà accedere alle informazioni riguardanti la propria busta paga e i turni che dovrà rispettare.
    \end{itemize}
  \item \textbf{Gestione dei Recapiti} \begin{itemize}
      \item Il sistema terrà traccia dello stato delle spedizioni prenotate, in corso ed effettuate in una base di dati.
      \item La base di dati interagirà con l'interfaccia fornita ai dipendenti che si occuperanno di aggiornare lo stato 
        delle spedizioni.
      \item Per ogni missiva presa in carico il sistema sarà responsabile di associarle un codice identificativo univoco a 
        6 cifre che contraddistinguerà l'oggetto dall'inizio alla fine della sua lavorazione,
    \end{itemize}
  \item \textbf{Gestione del Magazzino} \begin{itemize}
      \item Il magazzino interagirà con il sistema tramite una base di dati.
      \item La gestione del magazzino sarà strettamente legata alla gestione dei recapiti, in quanto il magazzino contiene 
        le corrispondenze in entrata e in uscita.
      \item Sarà possibile gestire ogni missiva tramite il codice e trovarla facilmente nonchè catalogarla in base ai suoi dati.
      \item Per ogni oggetto nel magazzino sarà anche memorizzata la sua posizione negli scaffali.
    \end{itemize}
  \item \textbf{Gestione Pagamenti} \begin{itemize}
      \item Il sistema avrà la funzione di monitoraggio dei pagamenti verso l'azienda OPCal.
      \item Il cliente potrà visualizzare lo stato dei propri pagamenti.
    \end{itemize}
  \item \textbf{Interfaccia} \begin{itemize}
      \item Il sistema provvede un'interfaccia per utenti e dipendenti.
      \item Tale interfaccia avrà una duplice implementazione, un sito web e un applicativo per dispostivi mobili (Android o IOS).
      \item Le funzionalità esposte al pubblico saranno tutte disponibili tramite le interfacce specificate.
    \end{itemize}
\end{enumerate}

\newpage
\section{Analisi dei Requisiti}
\subsection{Analisi dello scenario}

\begin{center}
  \includegraphics[width=0.8\linewidth]{assets/valueChain.png}
  \vspace{1cm}

  \newcolumntype{Y}{@{}>{\centering\arraybackslash}X @{}}
  \newcolumntype{R}{@{}>{\raggedright\arraybackslash}X @{}}

  \begin{tabularx}{\textwidth}{|*{5}{Y|}}
    \hline
    \textbf{Logistica in entrata (LE)} & \textbf{Attività operative (AO)} & \textbf{Logistica in uscita (LU)} & \textbf{Marketing e vendita (MV)} & \textbf{Servizi post-vendita (SPV)} \\ \hline

    \begin{tabular}{R}
      \hline
      LE1: registrazione cliente               \\ \hline
      LE2: aggiornamento dati cliente          \\ \hline
      LE3: registrazione operazioni dipendenti \\ \hline
      LE4: registrazione spedizioni in entrata \\ \hline
      LE5: registrazione pagamento             \\ \hline
      LE6: controllo magazzino                 \\ \hline
    \end{tabular} &

    \begin{tabular}{R}
      \hline
      AO1: invio corrispondenza                   \\ \hline
      AO2: monitoraggio spedizione                \\ \hline
      AO3: smistamento corrispondenza in arrivo   \\ \hline
      AO4: selezione spedizioni in uscita         \\ \hline
    \end{tabular} &

    \begin{tabular}{R}
      \hline
      LU1: notifica spedizione \\ \hline
      LU2: consegna a cliente  \\ \hline
      LU3: consegna ricevuta   \\ \hline
      LU4: pagamento corriere  \\ \hline
    \end{tabular} &

    \begin{tabular}{R}
      \hline
      MV1: incasso allo sportello   \\ \hline
      MV2: incasso con contrassegno \\ \hline
      MV3: comunicazione promozioni \\ \hline
    \end{tabular} &

    \begin{tabular}{R}
      \hline
      SPV1: gestione resi     \\ \hline
      SPV2: gestione reclami  \\ \hline
      SPV3: raccolta feedback \\ \hline
    \end{tabular} \\ 
    \hline

    \multicolumn{5}{|c|}{Approvvigionamenti (AP)}          \\ \hline
    \multicolumn{5}{|c|}{AP1: acquisto consumabili}        \\
    \multicolumn{5}{|c|}{AP2: acquisto nuova attrezzatura} \\
    \hline
    \multicolumn{5}{|c|}{Gestione risorse umane (GRU)}     \\ \hline
    \multicolumn{5}{|c|}{GRU1: gestione turni di lavoro}   \\
    \multicolumn{5}{|c|}{GRU2: gestione buste paga}        \\ 
    \multicolumn{5}{|c|}{GRU3: valutazione dipendenti}     \\
    \hline
    \multicolumn{5}{|c|}{Gestione infrastrutture (GI)}     \\ \hline
    \multicolumn{5}{|c|}{GI1: manutenzione}                \\
    \hline
  \end{tabularx}
\end{center}

\newpage
\subsubsection{Registrazione cliente}
\textbf{Nome processo} (identificativo): Registrazione cliente (LE1) \\
\textbf{Attori coinvolti}: Cliente, Sportellista, Portalettere \\
\textbf{Archivi coinvolti}: Lista clienti, Rubrica degli indirizzi\\ 
\textbf{Descrizione processo}: Un \textbf{cliente} può registrarsi recandosi fisicamente nella sede dell'ufficio e richiedendo l'apposito modulo di registrazione, 
da compilare con: nome, cognome, data di nascita e indirizzo (nel formato Via, CAP, Città, Provincia) e presentando un documento d'identità come patente o carta d'identità. 
Dopo di ciò lo \textbf{sportellista} dovrà premurarsi di controllare la coerenza delle informazioni all'interno del modulo confrontate con quelle dell documento d'identità. 
Lo \textbf{sportellista} inserirà il documento all'interno della \underline{lista degli utenti}, dove all'occorrenza inserirà anche i dati in merito alle spedizioni del \textbf{cliente}, (vedi LE4: registrazioni spedizioni in entrata) e all'interno della \underline{rubrica degli indirizzi} dove un \textbf{portalettere} 
(vedi LU2: consegna a cliente) può attingere per avere informazioni sul cliente a cui deve consengare.  Nel caso in cui il \textbf{cliente} volesse accedere ai 
suoi dati si deve recare in sede e richiederli allo \textbf{sportellista}, che attingerà alla \underline{lista degli utenti}, i dati presenti nella 
\underline{lista degli utenti} sono costantemente aggiornati dagli \textbf{sportellisti} per garantire la loro correttezza e completezza. 
Questi aggiornamenti possono includere modifiche ai dati personali del cliente, come variazioni di indirizzo o recapiti (vedi LE2: aggiornamento dati cliente). \\
\textbf{Processi correlati:}\\LE2,LE4, LU2.\\ \\
\underline{Cosiderazioni dopo l'implementazione del nuovo sistema informativo}: \\ Queste operazioni saranno gestite in automatico tramite l'apposita piattaforma, 
senza che il cliente vada in sede e senza che lo sportellista lo inserisca manualmente nell'archivio.
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{assets/activitydiagram_LE1.png}
  \caption{Activity Diagram di LE1}
\end{figure}
\begin{figure}[H]
  \centering
  \includegraphics[width=0.7\linewidth]{assets/dataflow_lvl0_LE1.png}
  \caption{Data Flow Diagram LVL 0 di LE1}
\end{figure}
\begin{figure}[H]
  \centering
  \includegraphics[width=0.7\linewidth]{assets/dataflow_lvl1_LE1.png}
  \caption{Data Flow Diagram LVL 1 di LE1}
\end{figure}

\newpage
\subsubsection{Invio corrispondenza}
\textbf{Nome processo} (identificativo): Invio corrispondenza (AO1) \\
\textbf{Attori coinvolti}: Responsabile recapito, Magazziniere, Corriere \\
\textbf{Archivi coinvolti}: Registro spedizioni, Inventario, Rubrica corrieri, Lista spedizioni odierne, Registro pagamenti \\
\textbf{Descrizione del processo}: Quando notificato da LE6, il \textbf{responsabile recapito} controlla nel \underline{registro spedizioni} il numero di articoli
da spedire verso l'esterno. Sceglie un sottoinsieme di articoli (si veda AO4) e compila la \underline{lista spedizioni odierne}, 
nella quale va ad inserire gli articoli da spedire in giornata. Una volta compilata la lista, consulta la \underline{rubrica corrieri} al fine
di trovare quello più conveniente alle condizioni specifiche. Una volta effettuata una stima, inizia a contattare le sedi di corrieri, a partire dalla più 
conveniente, fin quando trova un corriere disponibile in giornata, con il quale concorda un orario per il ritiro ed un prezzo.
Una volta trovato l'accordo con il corriere, compila il documento da mandare al \textbf{direttore}, il quale provvederà al pagamento del \textbf{corriere} (LU4)
e conserverà il documento nel \underline{registro pagamenti}. Il direttore si occuperà inoltre di stampare la ricevuta di pagamento e 
consegnarla ai \textbf{magazzinieri}.
Ricevuta la \underline{lista spedizioni odierne} i \textbf{magazzinieri} consultano l'\underline{inventario}, in cui è riportata la posizione dell'articolo
all'interno del magazzino, e lo mettono da parte, in attesa del \textbf{corriere}. All'arrivo di questo, consegnano la ricevuta e caricano sul furgone gli articoli messi da parte. \\
\textbf{Processi correlati:}\\AO4, LE6, LU4\\
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{assets/activitydiagram_AO1.png}
  \caption{Activity Diagram per AO1}
\end{figure}

Si riporta di seguito il dfd di livello 0:
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{assets/dfd_0_AO1.png}
  \caption{DFD per AO1}
\end{figure}
Si riporta di seguito il dfd di livello 1:
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{assets/dfd_1_AO1.png}
  \caption{DFD livello 1 per AO1}
\end{figure}

\subsubsection{Attori e archivi}
\begin{table}[H]
  \centering
  \begin{tabular}{|>{\centering\arraybackslash}m{0.20\textwidth}|
                  >{\centering\arraybackslash}m{0.24\textwidth}|
                  >{\centering\arraybackslash}m{0.12\textwidth}|
                  >{\centering\arraybackslash}m{0.33\textwidth}|}
    \hline
    \textbf{Attore} & \textbf{Descrizione} & \textbf{Processi in cui è coinvolto} & \textbf{Archivi a cui accede} \\ 
    \hline
    Cliente & Uno degli utenti dell'OPCAL & - LE1 & \\ 
    \hline 
    Sportellista & Uno dei dipendenti che lavora nella sezione sportello & -LE1 & \begin{itemize} \item Lista utenti 
    \item Rubrica degli indirizzi \end{itemize} \\ 
      \hline 
      Portalettere & Uno dei dipendenti che lavora nella sezione corrispondenze & -LE1 & $\bullet$ Rubrica degli indirizzi \\ 
      \hline
      Responsabile recapito & Il dipendente a capo del recapito & -AO1 &
      \begin{itemize}
        \item{Registro spedizioni}
        \item{Lista spedizioni odierne}
        \item{Rubrica corrieri}
      \end{itemize} \\
      \hline
      Direttore & Il responsabile generale, si occupa principalmente di contabilità & -AO1 &
      \begin{itemize}
        \item{Registro pagamenti}
      \end{itemize} \\
      \hline
      Magazziniere & Uno dei dipendenti addetto alla sezione magazzino & -AO1 &
      \begin{itemize}
        \item{Lista spedizioni odierne}
        \item{Inventario}
      \end{itemize} \\
      \hline
      Corriere & Un ente esterno che si occupa di gestire la corrispondenza verso zone non sotto la competenza di OPCal & -AO1 & \\
      \hline
  \end{tabular}
\end{table}

\begin{table}
  \centering
  \begin{tabular}{|>{\centering\arraybackslash}m{0.20\textwidth}|
                  >{\centering\arraybackslash}m{0.24\textwidth}|
                  >{\centering\arraybackslash}m{0.12\textwidth}|
                  >{\centering\arraybackslash}m{0.33\textwidth}|}
    \hline
    \textbf{Archivio} & \textbf{Descrizione} & \textbf{Processi in cui è coinvolto} & \textbf{Attori che vi accedono} \\ \hline
    Lista degli utenti & Archivio in cui sono scritte le informazioni su ogni utente, quali nome, cognome, codice fiscale, e-mail & -LE1 & \begin{itemize}
      \item Sportellista
    \end{itemize} \\ 
    \hline 
    Rubrica degli indirizzi & Archivio in cui sono scritte informazioni sugli utenti specifiche per i portalettere, queste sono nome, cognome, numero di telefono,
    indirizzo & -LE1 & \begin{itemize}
      \item Portalettere
    \end{itemize} \\ 
    \hline
    Registro spedizioni & Archivio in cui sono conservate le informazioni delle spedizioni accettate & -AO1 &
    \begin{itemize}
      \item{Sportellista}
      \item{Responsabile recapito}
    \end{itemize} \\
    \hline
    Inventario & Archivio che testimonia lo stato del magazzino, conservando informazioni sugli articoli in esso presenti & -AO1 &
    \begin{itemize}
      \item{Magazziniere}
    \end{itemize} \\
    \hline
  \end{tabular}
\end{table}

\newpage
\subsection{Specifica dei requisiti}
\subsubsection{Requisiti funzionali}
I gruppi funzionali che si è deciso di implementare sono quelli riguardanti la \textbf{gestione dei clienti} e la \textbf{gestione dei recapiti}.

\subsubsection*{Gestione clienti}
\begin{enumerate}
  \item{(MUST)} Implementare una schermata di sign-in [Cliente];
  \item{(MUST)} Inserimento dei propri dati anagrafici[Cliente];
  \item{(MUST)} Modifica dei propri dati anagrafici[Cliente];
  \item{(MUST)} Implementare la possibilità di poter registrare delle spedizioni[Cliente]; 
  \item{(MUST)} Implementare la possibilità di poter tracciare le spedizioni[Cliente];
  \item{(MUST)} Aggiungere una funzione per iniziare una procedura di reso[Cliente];
  \item{(MUST)} Scaricare tutti i documenti da compilare per procedere con il reso[Cliente];
  \item{(MUST)} Poter annullare o modificare una procedura di reso[Cliente];
  \item{(MUST)} Introdurre di un sistema di sicurezza per il login nella piattaforma[Cliente, Sportellista];
  \item{(MUST)} Dare la possibilità di avere uno storico delle consegne[Cliente];
  \item{(MUST)} Introdurre un ordinamento per lo storico delle consegne[Cliente]:
    \begin{enumerate}
      \item Per data, dalla più alla meno recente (Default);
      \item Per tipo di spedizione;
      \item Per numero di ordine;
      \item In ordine alfabetico.
    \end{enumerate} 
  \item{(MUST)} Visualizzare le ricevute a proprio carico[Cliente];
  \item {(MUST)} Ordinare la lista delle ricevute a proprio carico[Cliente]:
    \begin{enumerate}
      \item Per stato del pagamento (Default);
      \item Per data del pagamento;
      \item In ordine alfabetico;
    \end{enumerate}
  \item{(MUST)} Visualizzare in tempo reale lo stato delle spedizioni di ogni cliente [Sportellista];
  \item{(MUST)} Visualizzare in tempo reale lo stato dei pagamenti di ogni cliente [Sportellista];
  \item{(MUST)} Accedere ai dati anagrafici dei clienti [Sportellista, Portalettere];
  \item{(MUST)} Modificare i dati anagrafici dei clienti [Sportellista];
  \item{(MUST)} Accedere ai dati delle spedizioni dei clienti [Sportellista, Portalettere];
  \item{(MUST)} Modificare i dati in merito alle spedizioni dei clienti [Sportellista, Portalettere];
  \item {(MUST)}  Implementare un sistema di mailing [Sportellista]:
\end{enumerate}

Per il \textbf{Requisito 20, Implementare un sistema di mailing}, si riporta di seguito una descrizione dettagliata: \\
Attore Principale: Sportellista \\
Descrizione dello scenario principale:  
\begin{enumerate}
  \item Un cliente si registra all'interno della piattaforma;
  \item Inserisce nel campo e-mail il suo indirizzo;
  \item Viene creata una \textit{mailing list} e viene inserito all'interno questo cliente;
  \item Comincia una pratica di reso, richiede una spedizione oppure un'appuntamento in sede;
  \item Quando ci sono aggiornamenti su un qualcosa che concerne l'utente viene inviata una e-mail in materia;
  \item Nel caso in cui ci siano informazioni sui servizi dell'organizzazione possono essere mandati aggiornamenti tramite le \textit{newsletter}.
\end{enumerate}

Descrizione di scenari alternativi: \\
SA1 (Non arriva l'email di aggiornamento): 
\begin{enumerate}
  \item Viene mandata una seconda e-mail;
  \item Se il problema persiste si prova a sostituire l'indirizzo dell'utente o a creare una nuova mailing list.
\end{enumerate} 
Di seguito è riportato il diagramma dei casi d'uso per \textbf{l'Area Funzionale 1: Gestione clienti}, per semplificare la lettura è diviso in due :

\begin{figure}[H]
  \centering
  \includegraphics[width=11cm]{assets/usecase_clienti.png}
  \caption{Diagramma Casi d'Uso 1}
\end{figure}
\begin{figure}[H]
  \centering
  \includegraphics[width=11cm]{assets/usecase_clienti_2.png}
  \caption{Diagramma Casi d'Uso 2}
\end{figure}

\clearpage
\subsubsection*{Gestione recapiti}
\begin{enumerate}
  \item{(MUST)} Associare un cliente ai suoi dati rilevanti [sportellista, portalettere];
  \item{(MUST)} Visualizzare gli indirizzi dei clienti [portalettere];
  \item{(MUST)} Visualizzare le spedizioni in arrivo ad un indirizzo [portalettere];
  \item{(MUST)} Visualizzare le spedizioni da ritirare [portalettere];
  \item{(MUST)} Creare una spedizione [sportellista, cliente];
  \item{(MUST)} Distinguere tra spedizioni interne e spedizioni verso l'esterno [magazziniere];
  \item{(MUST)} Tenere traccia delle spedizioni prenotate, in corso ed effettuate [responsabile recapiti];
  \item{(MUST)} Modificare il ciclo di vita di una spedizione(prenotata, in corso, effettuata);
  \item{(MUST)} Prendere in carico una spedizione [sportellista, portalettere];
  \item{(MUST)} Aggiornare lo stato di una spedizione:
    \begin{enumerate}
      \item{Da "prenotata" a "presa in carico" [sportellista, portalettere]};
      \item{Da "presa in carico" a "spedita" [magazziniere]};
      \item{Da "spedita" a "arrivata alla filiale" [magazziniere]};
      \item{Da "arrivata alla filiale" a "in consegna" [magazziniere]};
      \item{Da "in consegna" a "consegnata" [portalettere]};
      \item{Da "in consegna" a "tentato recapito" [portalettere]};
    \end{enumerate}
  \item{(MUST)} Filtrare la lista degli indirizzi, di default ordinata per nome del cliente, secondo i seguenti criteri[portalettere]:
    \begin{enumerate}
      \item{Comune di appartenenza};
      \item{Orario preferito per la consegna};
      \item{Numero di ordini ricevuti};
      \item{Numero di ordini spediti};
      \item{Per data ultimo ordine};
      \item{Per data primo ordine};
    \end{enumerate}
  \item{(MUST)} Filtrare la lista delle spedizioni, di default ordinata per data, secondo i seguenti criteri:
    \begin{enumerate}
      \item{Per pagamento};
      \item{Per indirizzo di consegna};
      \item{Per indirizzo di partenza};
      \item{Per stato della spedizione};
    \end{enumerate}
  \item{(MUST)} Assegnare ad ogni spedizione un codice univoco [magazziniere, portalettere];
  \item{(MUST)} Identificare una spedizione solo tramite il suo codice [magazziniere, portalettere];
  \item{(MUST)} Visualizzare la lista dei corrieri esterni [responsabile recapito];
  \item{(MAY)}  Aggiornare la lista dei corrieri con i prezzi automaticamente aggiornati [responsabile recapito];
  \item{(MUST)} Calcolare un preventivo per il corriere esterno selezionato [responsabile recapito];
  \item{(MUST)} Prenotare il ritiro da parte di un corriere [responsabile recapito];
  \item{(MUST)} Registrare il pagamento al corriere [direttore]
\end{enumerate}
\textbf{N.B.} \\
Tenere a mente la distinzione tra \textbf{ciclo di vita} e \textbf{stato} di una spedizione. Il \textbf{ciclo di vita} si riferisce
alla situazione della spedizione(prenotata, in corso, effettuata). Per ognuna di queste, la spedizione verrà catalogata in basi di dati differenti.
Lo \textbf{stato} è proprio solo delle spedizioni \textit{in corso}(presa in carico, consegnata, ecc.).
\\ \\
Per il \textbf{caso d'uso 5 (Creare una spedizione)} segue descrizione dettagliata: \\
Una spedizione può essere creata da due attori separati:
\begin{enumerate}
  \item{Sportellista}: nel caso in cui un cliente si rechi in sede per effettuare una spedizione, l'intera operazione viene effettuata dallo sportellista;
  \item{Cliente}: il cliente può creare la spedizione tramite l'interfaccia offerta. Vedi 2.2.1.4;

\end{enumerate}
Di seguito è riportato il diagramma dei casi d'uso per \textbf{l'Area Funzionale 2: Gestione recapito} :
\begin{figure}[H]
  \centering
  \includegraphics[width=10cm]{assets/usecase_recapito_1.png}
\end{figure}
\begin{figure}[H]
  \centering
  \includegraphics[width=10cm]{assets/usecase_recapito_2.png}
\end{figure}
\begin{figure}[H]
  \centering
  \includegraphics[width=10cm]{assets/usecase_recapito_3.png}
\end{figure}
\begin{figure}[H]
  \centering
  \includegraphics[width=10cm]{assets/usecase_recapito_4.png}
  \caption{Diagramma Casi d'Uso Recapito}
\end{figure}

\subsubsection{Requisiti non funzionali}
Il sistema sarà inizialmente implementato tramite una propria applicazione per pc, che potrà essere utilizzata sia dal personale
che dalla clientela, differenziando i due casi tramite un sistema di autorizzazioni.\\\\
Il sistema dovrà avere le seguenti caratteristiche:
\begin{itemize}
  \item{\textbf{Multiutente}}: Diversi utenti, con permessi e livelli di autorità differenti dovranno potersi connettere e visualizzare dati
    contemporaneamente;
  \item{\textbf{Multi postazione}}: Il sistema dovrà consentire l'accesso a tutte le postazioni presenti in sede contemporaneamente;
  \item{\textbf{Indipendenza}}: Il sistema dovrà essere pronto all'utilizzo dopo un'unica installazione, soprattutto nel caso delle funzionalità offerte ai clienti;
  \item{\textbf{Piattaforma}}: Il sistema deve essere disponibile per il sistema operativo utilizzato in sede (Windows);
  \item{\textbf{Backup}}: Il sistema eseguirà un backup dei dati a cadenza settimanale;
  \item{\textbf{Sicurezza}}: Il sistema renderà sicura la gestione degli utenti, rendendo le alcune aree del programma accessibili solo dagli utenti con i permessi.
\end{itemize} 
\begin{table}[H]
  \newcolumntype{Y}{>{\centering\arraybackslash}m{\dimexpr\linewidth/3-2\tabcolsep - 4\arrayrulewidth}}

  \begin{tabularx}{\dimexpr\textwidth-7\arrayrulewidth}{|*{3}{Y|}} % altra stregoneria per cui vuole solo 7
    \hline
  \textbf{Utente/Ruolo} & \textbf{Funzioni a cui ha accesso} & \textbf{Requisito funzionale(numero)} \\ 
  \hline
  Amministratore & Tutte, inclusa la possibilità di aggiungere e/o rimuovere permessi & tutti \\ 
  \hline
  Responsabile magazzino & Può visualizzare tutto, ma può modificare solo le informazioni relative al magazzino & non implementati\\
  \hline
  Responsabile recapito & Può visualizzare tutto, ma può modificare solo le informazioni relative al recapito & 2.2.1.7, 10, 14, 15, 16, 18, e quelli elencati in 2.2.2 \\
  \hline
  Responsabile sportello & Può visualizzare tutto, ma può modificare solo le informazioni relative allo sportello & 2.2.2.2, 3, 4, 11, 12 \\
  \hline
  Dipendente & Può visualizzare e modificare solo le informazioni relative al proprio reparto & \\
  \hline
  Cliente & Può accedere solo ad un set prestabilito di funzioni & tutti quelli compresi tra 2.2.1.1 e 2.2.1.13\\
  \hline
\end{tabularx}
\end{table}
Di seguito è riportato un diagramma che raffigura la gerarchia tra gli utenti del sistema: 
\begin{figure}[H]
	\centering
	\includegraphics[width=4cm]{assets/diagramma_privilegi.png}
	\caption{Diagramma dei privilegi}
\end{figure}

\newpage
\section{Progettazione}
\subsection{Modellazione della base di dati}
Dai \textbf{requisiti} \textbf{2.2.1.1-3}, \textbf{2.2.1.16-17} si può dedurre che all'interno della base di dati dovranno essere rappresentati
i dati riguardanti i \textit{clienti}, specificatamente ogni utente sarà caratterizzato da id, nome, cognome, indirizzo ed e-mail. 
\\\\
Dai \textbf{requisiti} \textbf{2.2.1.5}, \textbf{2.2.1.18-19} e praticamente l'intero \textbf{requisito funzionale }\textbf{2.2.2} si evince che è importante descrivere i dati relativi alle \textit{spedizioni}, caratterizzate dal peso dal prezzo e dal codice, che le identifica anche. Inoltre specificatamente dai \textbf{requisiti} \textbf{2.2.2.8} si evince la necessità di rappresentare ogni ciclo di vita in una tabella a se stante:
\begin{itemize}
	\item Quando \textit{prenotata}, una spedizione sarà caratterizzata da un cliente emittente, data di prenotazione, 
	indirizzo di ritiro, data prevista di ritiro, cliente destinatario, peso e prezzo.
	
	\item Una volta ritirata, la spedizione verrà riferita come \textit{in corso} e sarà caratterizzata da emittente, 
	codice identificativo, data di spedizione, peso, prezzo, destinatario, data prevista di consegna e stato.
	
	\item Una volta consegnata, la spedizione sarà \textit{effettuata} e sarà caratterizzata da emittente, codice identificativo, 
	data di spedizione, data di consegna, destinatario, prezzo, peso.
\end{itemize}  
Dai \textbf{requisiti} \textbf{2.2.1.6-8} il cliente può far partire delle procedure di \textit{reso}, caratterizzate dal cliente che le ha fatte partire, la data in cui sono iniziate e la spedizione per cui è stata fatta partire. Un cliente può iniziare più resi, ma un reso è collegato a un unico cliente.
\\\\
Dai \textbf{requisiti} \textbf{2.2.1.10-11} si evince che il cliente deve avere associato la lista delle \textit{consegne} a proprio carico,  esse sono un tipo di \textit{spedizione}, ogni cliente può avere molte consegne o nessuna, ma una consegna può essere assegnata ad un unico cliente.
\\\\
I \textbf{requisiti} \textbf{2.2.1.12-13} ci dicono che ogni cliente deve avere a se relazionato la lista delle \textit{ricevute} a proprio carico, identificate dal numero della ricevuta e caratterizzata dalla data di emissione e dallo stato del pagamento, inoltre le ricevute sono connesse alla spedizione di tipo prenotata che hanno pagato, senza un pagamento una spedizione non verrà presa a carico da un corriere.Ogni ricevuta può avere un cliente, ma un cliente può averne molte come una consegna può avere una ricevuta e una ricevuta è per una sola consegna.
\\\\
Il \textbf{requisito} \textbf{2.2.2.11} ci guida verso la rappresentazione dei dati relativi agli indirizzi, che dovranno quindi includere 
email(identificativo), comune, orario preferito. \\ \\
Dal \textbf{requisito} \textbf{2.2.2.15} si evince la necessità di una rubrica corrieri. Ogni corriere sarà caratterizzato da nome, 
partita iva(identificativa), numero di telefono, sito web, prezzo per 1kg, prezzo per 10kg, prezzo per 100kg.

\subsubsection{Modello concettuale}
\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{assets/ER_diagram.jpg}
  \caption{Diagramma E-R}
\end{figure}
\subsubsection*{Vincoli d'integrità}
\begin{enumerate}
  \item Gli attributi \textit{data ritiro} e \textit{data consegna} devono sempre essere successivi rispettivamente a \textit{data prenotazione} e \textit{data spedizione};
	\item Il valore dell'attributo \textit{stato} all'interno del'entità \textit{reso} potrà essere solo: richiesto, processato, terminato;
	\item Il valore dell'attributo \textit{data} all'interno dell'entità \textit{reso} deve essere posteriore al valore \textit{data consegna} all'interno dell'entità \textit{Effettuata};
	\item Il valore dell'attributo \textit{codice} di \textit{Spedizione} deve avere una formattazione del tipo S12345;
	\item Il valore dell'attributo \textit{stato} dell'entità \textit{ricevuta} può essere: pagamento confermato, non regolarizzata. 
	\item Il valore dell'attributo \textit{stato} all'interno dell'entità \textit{in corso} potrà essere solo: presa in carico, spedita, arrivata alla filiale, in consegna, consegnata, in attesa di ritiro;
	\item Gli attributi \textit{data di ritiro} e \textit{data consegna} devono sempre essere successivi rispettivamente a \textit{data prenotazione} e \textit{data spedizione};
	\item Il valore dell'attributo \textit{stato} all'interno del'entità \textit{reso} potrà essere solo: richiesto, processato, terminato;
	\item Il valore dell'attributo \textit{codice} di \textit{Spedizione} deve avere una formattazione del tipo S12345;
	
\end{enumerate}

\subsubsection*{Regole di derivazione}
Alcuni attributi devono essere derivati automaticamente dal sistema:
\begin{itemize}
  \item L'attributo id della relazione cliente è un numero progressivo che identifica univocamente il cliente;
  
\end{itemize}
\subsubsection*{Dizionario dei concetti per entità}
\begin{table}[H]
	\centering
	\newcolumntype{Y}{>{\centering\arraybackslash}m{\dimexpr\linewidth/4-2\tabcolsep - 5\arrayrulewidth}}
	\begin{tabularx}{\dimexpr\textwidth-15\arrayrulewidth}{|*{4}{Y|}} %sempre 15 manco io so perché
		\hline
		\textbf{Entità} & \textbf{Descrizione} & \textbf{Attributi} & \textbf{Identificatore} \\ \hline
		 Reso & Rappresenta i resi iniziati dai clienti & Data,stato, cliente associato & Cliente associato \\
		 \hline
		 Cliente & Rappresenta i clienti dell'organizzazione & Nome, cognome, id, e-mail & ID \\
		\hline 
		Indirizzo & Rappresenta l'indirizzo di spedizione dei clienti & Comune, Via, Civico, Orario, Cliente & Comune, Via, Civico \\ 
		\hline
		Ricevuta & Rappresenta le ricevute delle spedizioni dei clienti & Codice, stato, importo, data & Codice\\
		\hline
		Spedizione & Rappresenta le spedizioni & Codice, peso, prezzo & Codice \\ 
		\hline
		Effettuata & Rappresenta le spedizioni effettuate & Quelle dell'entità madre, data di cosegna, data di spedizione & Codice entità madre \\
		\hline
		In corso & Rappresenta le spedizioni in corso & Quelle dell'entità madre, data di spedizione, stato & Codice entità madre \\
		\hline
		Prenotata & Rappresenta le spedizioni prenotate & Quelle dell'entità madre, data di prenotazione, data di ritiro & Codice entità madre \\
		\hline
		Corriere & Rappresenta i corrieri associati all'organizzazione & Partita IVA, sito web, nome, telefono, prezzo 1kg, prezzo 10kg, prezzo 100kg & Partita IVA \\
		\hline 
	\end{tabularx}
\end{table}

\subsubsection*{Dizionario dei concetti per relazione}
\begin{table}[H]
	\centering
	\newcolumntype{Y}{>{\centering\arraybackslash}m{\dimexpr\linewidth/4-2\tabcolsep - 5\arrayrulewidth}}
	\begin{tabularx}{\dimexpr\textwidth-15\arrayrulewidth}{|*{4}{Y|}} %sempre 15 manco io so perché
		\hline
		\textbf{Relazione} & \textbf{Descrizione} & \textbf{Entità coinvolte} & \textbf{Attributi} \\ \hline
		$R_{rs}$ & Associa i resi ai clienti & Reso, Cliente & \\ 
		\hline
		$R_{ci}$ & Associa i clienti ai loro indirizzi & Cliente, Indirizzo & \\ 
    \hline
    $R_{fc}$ & Associa i clienti alle loro ricevute & Ricevuta, Cliente & \\
    \hline
    Manda & Associa il cliente alla spedizione che fa spedire & Cliente, Spedizione & \\
    \hline 
    Riceve & Associa il cliente alla spedizione che riceve & Cliente, Spedizione & \\
    \hline
    Ritiro & Associa la spedizione di tipo prenotata all'indirizzo in cui verrà ritirata & Prenotata, Indirizzo & \\
    \hline 
    $R_{re}$ & Associa il reso alla spedizione di tipo effettuata su cui è stato effettuato & Reso, Effettuata & \\ \hline 
	\end{tabularx}
\end{table}

\subsubsection{Modello relazionale}
La sintassi utilizzata nel modello relazionale è la seguente:
\begin{itemize}
  \item Per ogni schema di relazione, il nome viene indicato in grassetto, mentre i suoi attributi sono espressi tra parentesi, ad esempio \textbf{Relazione}(attributo1,.., attributoN)
  \item Negli schemi di relazione, vengono indicati i vincoli di chiave primaria sottolineando gli attributi parte della chiave, ad esempio \textbf{Relazione}(\underline{attributo1, attributo2},.., attributoN)
  \item Eventuali altri chiavi verranno specificate al di sotto della relazione con la keyword "Unique" in corsivo, ad esempio \\ \textbf{Relazione}(\underline{chiave}, attributo)\\ \textit{Unique}(attributo)
  \item Eventuali vincoli di integrità referenziale saranno descritti al di sotto della relazione a cui appartengono, nella forma \textbf{R1}(a1) $\subseteq _{FK}$ \textbf{R2}(a1);
  \item Per indicare che un attributo può essere NULL, viene indicato al pedice dell'attributo la dicitura NULL, ad esempio \textbf{R}(\underline{k}, A1$_{NULL}$, A2) indica che l'attributo A1 potrebbe essere NULL;
\end{itemize}

I tipi di dato utilizzati per gli attributi sono i seguenti:
\begin{itemize}
  \item INT: quantità intere;
  \item FLOAT: prezzi, pesi;
  \item DATE: rappresenta le date nel formato gg/mm/aaaa;
  \item VAR\_CHAR: stringhe di testo, codici alfanumerici;
\end{itemize}

Il modello relazionale sarà il seguente:
\begin{itemize}
  \item \textbf{Cliente}(\underline{ID}, Nome, Cognome, Email);
  \item \textbf{Indirizzo}(\underline{Comune, Via, Civico}, Orario, IdCliente) \\ \textbf{Indirizzo}(IdCliente) $\subseteq _{FK}$ \textbf{Cliente}(ID); 
  \item \textbf{Ricevuta}(\underline{Codice}, Stato, Data)\\ \textbf{Ricevuta}(Codice) $\subseteq _{FK}$ \textbf{Spedizione}(Codice);
  \item \textbf{Spedizione}(\underline{Codice}, Peso, Prezzo, IdMittente, IdDestinatario) \\ \textbf{Spedizione}(IdMittente) $\subseteq _{FK}$ \textbf{Cliente}(Id) \\ \textbf{Spedizione}(IdDestinatario) $\subseteq _{FK}$ \textbf{Cliente}(Id);
  \item \textbf{Effettuata}(\underline{Codice}, DataConsegna, DataSpedizione)\\\textbf{Effettuata}(Codice) $\subseteq _{FK}$ \textbf{Spedizione}(Codice) \\ Lo schema di dati \textbf{Effettuata} di fatto funge da storico delle spedizioni;
  \item \textbf{InCorso}(\underline{Codice}, DataSpedizione, Stato) \\ \textbf{InCorso}(Codice) $\subseteq _{FK}$ \textbf{Spedizione}(Codice);
  \item \textbf{Prenotata}(\underline{Codice}, DataRitiro, DataPrenotazione) \\\textbf{Prenotata}(Codice)$\subseteq _{FK}$\textbf{Spedizione}(Codice);
  \item \textbf{Corriere}(\underline{IVA}, Nome, Sito, Telefono, Prezzo1, Prezzo10, Prezzo100);
  \item \textbf{Reso}(\underline{Codice}, Data, Stato)\\ \textbf{Reso}(Codice) $\subseteq _{FK}$ \textbf{Effettuata}(Codice);
\end{itemize}

\subsubsection*{Triggers}
In merito al \textit{vincolo di integrità} 4 che tratta lo schema di relazione \textbf{Reso}(\underline{IdMittente}, Data, Stato) ed \textbf{Effettuata}(Codice, IdMittente), nel momento in cui all'interno dell'attributo data dell'entità \textbf{Reso} si vuole inserire una nuova tupla bisogna controllare che la condizione per cui la \textit{Data} che si sta cercando di inserire nel \textbf{Reso} sia maggiore (posteriore) a quella che è attualmente all'interno di \textit{DataConsegna }di \textbf{Effettuata}.
\begin{minted}[linenos]{sql}
DELIMITER //
CREATE TRIGGER 'vincoli_date_insert'
BEFORE INSERT ON Reso
FOR EACH ROW BEGIN
IF (EXISTS 
	(SELECT *
	FROM Effettuata
	WHERE NEW.data > dataCosegna))
THEN SIGNAL SQLSTATE '45000'
	SET MESSAGE_TEXT = 'Vincolo di integrità su Reso non rispettato';
END IF;
END //
DELIMITER;
\end{minted}
Di seguito è anche riportata la versione analoga per gli aggiornamenti nella tupla.
\begin{minted}[linenos]{sql}
DELIMITER //
CREATE TRIGGER 'vincoli_date_update' 
BEFORE UPDATE ON Reso
FOR EACH ROW BEGIN
IF (EXISTS 
	(SELECT *
	FROM Effettuata
	WHERE NEW.data > dataCosegna))
THEN SIGNAL SQLSTATE '45000'
	SET MESSAGE_TEXT = 'Vincolo di integrità su Reso non rispettato';
END IF;
END //
DELIMITER;
\end{minted}
 Un altro vincolo d'integrità è quello per valore dell'attributo \textit{Stato} all'interno di \textbf{Ricevuta}, quando si va ad inserire bisogna infatti controllare che sia all'interno dell'insieme degli stati ammissibili.
 \begin{minted}[linenos]{sql}
 DELIMITER //
 CREATE TRIGGER 'vincoli_ricevute_insert'
 BEFORE INSERT ON Ricevuta
 FOR EACH ROW BEGIN 
IF (NEW.stato NOT IN ('pagamento confermato', 'non regolarizzata'))
 THEN SIGNAL SQLSTATE '4500'
 	SET MESSAGE_TEXT ='Vincolo di integrità su Ricevuta non rispettato';
 END IF;
 END //
 DELIMETER;
 \end{minted}
Segue la versione analoga per gli update.
\begin{minted}[linenos]{sql}
DELIMITER //
CREATE TRIGGER 'vincoli_ricevute_insert'
BEFORE UPDATE ON Ricevuta
FOR EACH ROW BEGIN 
IF (NEW.stato NOT IN ('pagamento confermato', 'non regolarizzata'))
THEN SIGNAL SQLSTATE '4500'
	SET MESSAGE_TEXT ='Vincolo di integrità su Ricevuta non rispettato';
END IF;
END //
DELIMETER;
\end{minted}

\subsection{Modellazione della logica di business}
\subsection{Modellazione delle interfacce}

\section{Implementazione}

\end{document}
